#!/usr/bin/env ruby

require 'import_js'

word = ARGV.delete_at(0)
file_contents = STDIN.read.split("\n")

editor = ImportJS::CommandLineEditor.new(word, file_contents)
importer = ImportJS::Importer.new(editor)
if word
  importer.import
else
  importer.import_all
end

# Print messages to stderr
STDERR.puts editor.messages

# Print resulting file to stdout
puts editor.current_file_content
